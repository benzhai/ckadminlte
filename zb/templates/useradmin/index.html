{% extends 'admin/master.html' %}
{% block body %}
{{ super() }}
<div class="container">
    <div class="row">
        <div class="col-lg-4 col-xs-6">
            <small>
                <li>共有 {{ g_stat['total'] }} 个CK</li>
                <li>总请求数： {{ g_stat['req'] }}， 重复请求： {{ g_stat['rereq'] }} , 分配成功： {{ g_stat['asigned'] }} , 分配失败： {{ g_stat['none'] }}</li>
                </br>
                <li>启动时间：{{ g_stat['boot_ts'] }} </li>
                <li>重置时间：{{ g_stat['reset_ts'] }} </li>
            </small>
        </div>


        <div class="col-lg-5 col-xs-6">
            <form action="/useradmin/upload?user={{ user }}" enctype='multipart/form-data' method='POST'>
                    <div class="row">
                        <div class="col-md-2">
                            <button class="btn btn-primary btn-sm" type="submit">上传CK</button>
                        </div>
                        <div class="custom-file">
                            <small>
                                <input type="file" class="custom-file-input form-control-sm" name="file" size="5">
                            </small>
                        </div>
                    </div>
            </form>
            </br>

            <form class="form-inline" action="/useradmin/take_cks_by_id?user={{ user }}" enctype='multipart/form-data' method='POST'>
                <div class="row">
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-primary btn-sm">取出CK</button>
                    </div>
                    <div class="input-group input-group-sm mb-3">
                        <input type="text" class="form-control" placeholder="ID Index Begin" value="0" name="ck_index" size="5" />
                    </div>
                    <div class="input-group input-group-sm mb-3">
                        <input type="text" class="form-control" placeholder="Num" value="1000" name="ck_num" size="5" />
                    </div>

                </div>
            </form>

        </div>

        <div class="col-md-2">
            <form action="/useradmin/act_reset?user={{ user }}" enctype='multipart/form-data' method='POST'>
                <div class="row">
                    <div class="col-md-3">
                        <button type="submit" class="btn btn-primary btn-sm">分配重置</button>
                    </div>
                </div>
            </form>
            <br>
            <form class="form-inline" action="/useradmin/act_clear?user={{ user }}" enctype='multipart/form-data' method='POST'>
                <div class="row">
                    <div class="col-md-3">
                        <button type="submit" class="btn btn-primary btn-sm">清空记录</button>
                    </div>
                </div>
            </form>
            <br>
            <form class="form-inline" action="/useradmin/act_reboot" enctype='multipart/form-data' method='POST'>
                <div class="row">
                    <div class="col-md-3">
                        <button type="submit" class="btn btn-primary btn-sm">reboot_server</button>
                    </div>
                </div>
            </form>
        </div>

    </div>
</div>

<div class="table-responsive-lg">
    <table class="table table-striped table-dark">
      <thead>
        <tr>
          <th scope="col">ID.</th>
          <th scope="col">状态</th>
          <th scope="col">UserID</th>
          <th scope="col">总时间</th>
          <th scope="col">停留时间</th>
          <th scope="col">需求数量</th>
          <th scope="col">已投数量</th>
          <th scope="col">ck请求数量</th>
          <th scope="col">投放间隔</th>
          <th scope="col">间隔次数</th>
          <th scope="col">开始时间</th>
          <th scope="col">房间</th>
          <th scope="col">CK</th>
        </tr>
      </thead>
      <tbody>
      {% for record in task_records %}
        <tr>
          <th scope="row">{{ record['task_id'] }}</th>
          <td>{{ record['status'] }}</td>
          <td>{{ record['user_id'] }}</td>
          <td>{{ record['total_time'] }}</td>
          <td>{{ record['last_time_from'] }}---{{ record['last_time_to'] }}</td>
          <td>{{ record['user_num'] }}</td>
          <td>{{ record['req'] }}</td>
          <td>{{ record['ck_req'] }}</td>
          <td>{{ record['time_gap'] }}</td>
          <td>{{ record['gap_num'] }}</td>
          <td>{{ record['begin_time'] }}</td>
          <td>{{ record['room_url'] }}</td>
          <td>{{ record['ck_url'] }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
</div>
{% endblock body %}
